{"ast":null,"code":"import _createForOfIteratorHelper from\"/home/thalusa/Documents/ResearchShare-v2/reactrs/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _regeneratorRuntime from\"/home/thalusa/Documents/ResearchShare-v2/reactrs/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/thalusa/Documents/ResearchShare-v2/reactrs/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{initialize}from'zokrates-js';export var zokrates=initialize();export function compile(_x){return _compile.apply(this,arguments);}function _compile(){_compile=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(zokrates){var request,program,encoder,hashBuffer,hashArray,hashHex,artifacts;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"reviewer.zok\");case 2:request=_context.sent;if(!(request.ok===false)){_context.next=5;break;}throw new Error(request.statusText);case 5:_context.next=7;return request.text();case 7:program=_context.sent;encoder=new TextEncoder().encode(program);_context.next=11;return crypto.subtle.digest('SHA-256',encoder);case 11:hashBuffer=_context.sent;hashArray=Array.from(new Uint8Array(hashBuffer));hashHex=hashArray.map(function(b){return b.toString(16).padStart(2,'0');}).join('');if(!(hashHex!==\"242b3ca12d88c4d5fa428520e49a5a3af7f82331474dca943d52b9816050b9d8\")){_context.next=16;break;}throw new Error(\"Corruped or invalid data.\");case 16:artifacts=zokrates.compile(program);return _context.abrupt(\"return\",artifacts);case 18:case\"end\":return _context.stop();}}},_callee);}));return _compile.apply(this,arguments);}export function compute(_x2,_x3,_x4,_x5){return _compute.apply(this,arguments);}function _compute(){_compute=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(zokrates,artifacts,reviewers,computeArguments){var reviewersHashes,argumentsHashes,_iterator,_step,reviewer,encoder,hashBuffer,hashArray,hashHex,finalHashHex,i,_iterator2,_step2,argument,_encoder,_hashBuffer,_hashArray,_hashHex,_finalHashHex,_i,result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:reviewersHashes=[];argumentsHashes=[];_iterator=_createForOfIteratorHelper(reviewers);_context2.prev=3;_iterator.s();case 5:if((_step=_iterator.n()).done){_context2.next=18;break;}reviewer=_step.value;encoder=new TextEncoder().encode(reviewer);_context2.next=10;return crypto.subtle.digest('SHA-256',encoder);case 10:hashBuffer=_context2.sent;hashArray=Array.from(new Uint8Array(hashBuffer));hashHex=hashArray.map(function(b){return b.toString(16);});finalHashHex=[];for(i=0;i<32;i+=4){finalHashHex.push(hashHex[i]+hashHex[i+1]+hashHex[i+2]+hashHex[i+3]);}reviewersHashes.push(finalHashHex);case 16:_context2.next=5;break;case 18:_context2.next=23;break;case 20:_context2.prev=20;_context2.t0=_context2[\"catch\"](3);_iterator.e(_context2.t0);case 23:_context2.prev=23;_iterator.f();return _context2.finish(23);case 26:_iterator2=_createForOfIteratorHelper(computeArguments);_context2.prev=27;_iterator2.s();case 29:if((_step2=_iterator2.n()).done){_context2.next=42;break;}argument=_step2.value;_encoder=new TextEncoder().encode(argument);_context2.next=34;return crypto.subtle.digest('SHA-256',_encoder);case 34:_hashBuffer=_context2.sent;_hashArray=Array.from(new Uint8Array(_hashBuffer));_hashHex=_hashArray.map(function(b){return b.toString(16);});_finalHashHex=[];for(_i=0;_i<32;_i+=4){_finalHashHex.push(_hashHex[_i]+_hashHex[_i+1]+_hashHex[_i+2]+_hashHex[_i+3]);}argumentsHashes.push(_finalHashHex);case 40:_context2.next=29;break;case 42:_context2.next=47;break;case 44:_context2.prev=44;_context2.t1=_context2[\"catch\"](27);_iterator2.e(_context2.t1);case 47:_context2.prev=47;_iterator2.f();return _context2.finish(47);case 50:result=zokrates.computeWitness(artifacts,[reviewersHashes,argumentsHashes]);return _context2.abrupt(\"return\",result);case 52:case\"end\":return _context2.stop();}}},_callee2,null,[[3,20,23,26],[27,44,47,50]]);}));return _compute.apply(this,arguments);}export function keypair(zokrates,artifacts){var keypair=zokrates.setup(artifacts.program);return keypair;}export function proof(zokrates,artifacts,result,keypair){var proof=zokrates.generateProof(artifacts.program,result.witness,keypair.pk);return proof;}export function verifier(zokrates,keypair){var verifier=zokrates.exportSolidityVerifier(keypair.vk,\"v2\");return verifier;}","map":{"version":3,"sources":["/home/thalusa/Documents/ResearchShare-v2/reactrs/src/utils/Zokrates.ts"],"names":["initialize","zokrates","compile","fetch","request","ok","Error","statusText","text","program","encoder","TextEncoder","encode","crypto","subtle","digest","hashBuffer","hashArray","Array","from","Uint8Array","hashHex","map","b","toString","padStart","join","artifacts","compute","reviewers","computeArguments","reviewersHashes","argumentsHashes","reviewer","finalHashHex","i","push","argument","result","computeWitness","keypair","setup","proof","generateProof","witness","pk","verifier","exportSolidityVerifier","vk"],"mappings":"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","sourcesContent":["import { initialize, ZoKratesProvider, CompilationArtifacts, ComputationResult, SetupKeypair, Proof } from 'zokrates-js';\n\nexport const zokrates = initialize();\n\nexport async function compile(zokrates: ZoKratesProvider): Promise<CompilationArtifacts> {\n    const request = await fetch(\"reviewer.zok\");\n    if (request.ok === false)\n        throw new Error(request.statusText);\n    const program = await request.text();\n    const encoder = new TextEncoder().encode(program);\n    const hashBuffer = await crypto.subtle.digest('SHA-256', encoder);\n    const hashArray = Array.from(new Uint8Array(hashBuffer));\n    const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('')\n    if (hashHex !== \"242b3ca12d88c4d5fa428520e49a5a3af7f82331474dca943d52b9816050b9d8\")\n        throw new Error(\"Corruped or invalid data.\");\n    const artifacts = zokrates.compile(program);\n    return artifacts\n}\n\nexport async function compute(zokrates: ZoKratesProvider, artifacts: CompilationArtifacts, reviewers: Array<string>, computeArguments: Array<string>): Promise<ComputationResult> {\n    const reviewersHashes = []; \n    const argumentsHashes = [];\n    for (const reviewer of reviewers) {\n        const encoder = new TextEncoder().encode(reviewer);\n        const hashBuffer = await crypto.subtle.digest('SHA-256', encoder);\n        const hashArray = Array.from(new Uint8Array(hashBuffer));\n        const hashHex = hashArray.map(b => b.toString(16))\n        const finalHashHex = [];\n        for (let i = 0; i < 32; i += 4)\n            finalHashHex.push(hashHex[i] + hashHex[i + 1] + hashHex[i + 2] + hashHex[i + 3]);\n        reviewersHashes.push(finalHashHex);\n    }\n    for (const argument of computeArguments) {\n        const encoder = new TextEncoder().encode(argument);\n        const hashBuffer = await crypto.subtle.digest('SHA-256', encoder);\n        const hashArray = Array.from(new Uint8Array(hashBuffer));\n        const hashHex = hashArray.map(b => b.toString(16))\n        const finalHashHex = [];\n        for (let i = 0; i < 32; i += 4)\n            finalHashHex.push(hashHex[i] + hashHex[i + 1] + hashHex[i + 2] + hashHex[i + 3]);\n        argumentsHashes.push(finalHashHex);\n    }\n    const result = zokrates.computeWitness(artifacts, [reviewersHashes, argumentsHashes]);\n    return result;\n}\n\nexport function keypair(zokrates: ZoKratesProvider, artifacts: CompilationArtifacts): SetupKeypair {\n    const keypair = zokrates.setup(artifacts.program);\n    return keypair;\n}\n\nexport function proof(zokrates: ZoKratesProvider, artifacts: CompilationArtifacts, result: ComputationResult, keypair: SetupKeypair): Proof {\n    const proof = zokrates.generateProof(artifacts.program, result.witness, keypair.pk);\n    return proof;\n}\n\nexport function verifier(zokrates: ZoKratesProvider, keypair: SetupKeypair): string {\n    const verifier = zokrates.exportSolidityVerifier(keypair.vk, \"v2\");\n    return verifier;\n}"]},"metadata":{},"sourceType":"module"}
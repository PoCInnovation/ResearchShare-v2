{"ast":null,"code":"var _require = require('buffer'),\n    Buffer = _require.Buffer;\n\nvar alloc = Buffer.alloc;\nvar ZEROS = '0000000000000000000';\nvar SEVENS = '7777777777777777777';\nvar ZERO_OFFSET = '0'.charCodeAt(0);\nvar USTAR_MAGIC = Buffer.from('ustar\\x00', 'binary');\nvar USTAR_VER = Buffer.from('00', 'binary');\nvar MASK = parseInt('7777', 8);\nvar MAGIC_OFFSET = 257;\nvar VERSION_OFFSET = 263;\n\nvar toTypeflag = function toTypeflag(flag) {\n  switch (flag) {\n    case 'file':\n      return 0;\n\n    case 'link':\n      return 1;\n\n    case 'symlink':\n      return 2;\n\n    case 'character-device':\n      return 3;\n\n    case 'block-device':\n      return 4;\n\n    case 'directory':\n      return 5;\n\n    case 'fifo':\n      return 6;\n\n    case 'contiguous-file':\n      return 7;\n\n    case 'pax-header':\n      return 72;\n  }\n\n  return 0;\n};\n\nvar cksum = function cksum(block) {\n  var sum = 8 * 32;\n\n  for (var i = 0; i < 148; i++) {\n    sum += block[i];\n  }\n\n  for (var j = 156; j < 512; j++) {\n    sum += block[j];\n  }\n\n  return sum;\n};\n\nvar encodeOct = function encodeOct(val, n) {\n  val = val.toString(8);\n  if (val.length > n) return SEVENS.slice(0, n) + ' ';else return ZEROS.slice(0, n - val.length) + val + ' ';\n};\n\nvar addLength = function addLength(str) {\n  var len = Buffer.byteLength(str);\n  var digits = Math.floor(Math.log(len) / Math.log(10)) + 1;\n  if (len + digits >= Math.pow(10, digits)) digits++;\n  return len + digits + str;\n};\n\nexports.encodePax = function (opts) {\n  // TODO: encode more stuff in pax\n  var result = '';\n  if (opts.name) result += addLength(' path=' + opts.name + '\\n');\n  if (opts.linkname) result += addLength(' linkpath=' + opts.linkname + '\\n');\n  var pax = opts.pax;\n\n  if (pax) {\n    for (var key in pax) {\n      result += addLength(' ' + key + '=' + pax[key] + '\\n');\n    }\n  }\n\n  return Buffer.from(result);\n};\n\nexports.encode = function (opts) {\n  var buf = alloc(512);\n  var name = opts.name;\n  var prefix = '';\n  if (opts.typeflag === 5 && name[name.length - 1] !== '/') name += '/';\n  if (Buffer.byteLength(name) !== name.length) return null; // utf-8\n\n  while (Buffer.byteLength(name) > 100) {\n    var i = name.indexOf('/');\n    if (i === -1) return null;\n    prefix += prefix ? '/' + name.slice(0, i) : name.slice(0, i);\n    name = name.slice(i + 1);\n  }\n\n  if (Buffer.byteLength(name) > 100 || Buffer.byteLength(prefix) > 155) return null;\n  if (opts.linkname && Buffer.byteLength(opts.linkname) > 100) return null;\n  buf.write(name);\n  buf.write(encodeOct(opts.mode & MASK, 6), 100);\n  buf.write(encodeOct(opts.uid, 6), 108);\n  buf.write(encodeOct(opts.gid, 6), 116);\n  buf.write(encodeOct(opts.size, 11), 124);\n  buf.write(encodeOct(opts.mtime.getTime() / 1000 | 0, 11), 136);\n  buf[156] = ZERO_OFFSET + toTypeflag(opts.type);\n  if (opts.linkname) buf.write(opts.linkname, 157);\n  USTAR_MAGIC.copy(buf, MAGIC_OFFSET);\n  USTAR_VER.copy(buf, VERSION_OFFSET);\n  if (opts.uname) buf.write(opts.uname, 265);\n  if (opts.gname) buf.write(opts.gname, 297);\n  buf.write(encodeOct(opts.devmajor || 0, 6), 329);\n  buf.write(encodeOct(opts.devminor || 0, 6), 337);\n  if (prefix) buf.write(prefix, 345);\n  buf.write(encodeOct(cksum(buf), 6), 148);\n  return buf;\n};","map":{"version":3,"sources":["/home/thalusa/Documents/ResearchShare-v2/node_modules/it-tar/pack-headers.js"],"names":["require","Buffer","alloc","ZEROS","SEVENS","ZERO_OFFSET","charCodeAt","USTAR_MAGIC","from","USTAR_VER","MASK","parseInt","MAGIC_OFFSET","VERSION_OFFSET","toTypeflag","flag","cksum","block","sum","i","j","encodeOct","val","n","toString","length","slice","addLength","str","len","byteLength","digits","Math","floor","log","pow","exports","encodePax","opts","result","name","linkname","pax","key","encode","buf","prefix","typeflag","indexOf","write","mode","uid","gid","size","mtime","getTime","type","copy","uname","gname","devmajor","devminor"],"mappings":"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","sourcesContent":["const { Buffer } = require('buffer')\n\nvar alloc = Buffer.alloc\n\nvar ZEROS = '0000000000000000000'\nvar SEVENS = '7777777777777777777'\nvar ZERO_OFFSET = '0'.charCodeAt(0)\nvar USTAR_MAGIC = Buffer.from('ustar\\x00', 'binary')\nvar USTAR_VER = Buffer.from('00', 'binary')\nvar MASK = parseInt('7777', 8)\nvar MAGIC_OFFSET = 257\nvar VERSION_OFFSET = 263\n\nvar toTypeflag = function (flag) {\n  switch (flag) {\n    case 'file':\n      return 0\n    case 'link':\n      return 1\n    case 'symlink':\n      return 2\n    case 'character-device':\n      return 3\n    case 'block-device':\n      return 4\n    case 'directory':\n      return 5\n    case 'fifo':\n      return 6\n    case 'contiguous-file':\n      return 7\n    case 'pax-header':\n      return 72\n  }\n\n  return 0\n}\n\nvar cksum = function (block) {\n  var sum = 8 * 32\n  for (var i = 0; i < 148; i++) sum += block[i]\n  for (var j = 156; j < 512; j++) sum += block[j]\n  return sum\n}\n\nvar encodeOct = function (val, n) {\n  val = val.toString(8)\n  if (val.length > n) return SEVENS.slice(0, n) + ' '\n  else return ZEROS.slice(0, n - val.length) + val + ' '\n}\n\nvar addLength = function (str) {\n  var len = Buffer.byteLength(str)\n  var digits = Math.floor(Math.log(len) / Math.log(10)) + 1\n  if (len + digits >= Math.pow(10, digits)) digits++\n\n  return (len + digits) + str\n}\n\nexports.encodePax = function (opts) { // TODO: encode more stuff in pax\n  var result = ''\n  if (opts.name) result += addLength(' path=' + opts.name + '\\n')\n  if (opts.linkname) result += addLength(' linkpath=' + opts.linkname + '\\n')\n  var pax = opts.pax\n  if (pax) {\n    for (var key in pax) {\n      result += addLength(' ' + key + '=' + pax[key] + '\\n')\n    }\n  }\n  return Buffer.from(result)\n}\n\nexports.encode = function (opts) {\n  var buf = alloc(512)\n  var name = opts.name\n  var prefix = ''\n\n  if (opts.typeflag === 5 && name[name.length - 1] !== '/') name += '/'\n  if (Buffer.byteLength(name) !== name.length) return null // utf-8\n\n  while (Buffer.byteLength(name) > 100) {\n    var i = name.indexOf('/')\n    if (i === -1) return null\n    prefix += prefix ? '/' + name.slice(0, i) : name.slice(0, i)\n    name = name.slice(i + 1)\n  }\n\n  if (Buffer.byteLength(name) > 100 || Buffer.byteLength(prefix) > 155) return null\n  if (opts.linkname && Buffer.byteLength(opts.linkname) > 100) return null\n\n  buf.write(name)\n  buf.write(encodeOct(opts.mode & MASK, 6), 100)\n  buf.write(encodeOct(opts.uid, 6), 108)\n  buf.write(encodeOct(opts.gid, 6), 116)\n  buf.write(encodeOct(opts.size, 11), 124)\n  buf.write(encodeOct((opts.mtime.getTime() / 1000) | 0, 11), 136)\n\n  buf[156] = ZERO_OFFSET + toTypeflag(opts.type)\n\n  if (opts.linkname) buf.write(opts.linkname, 157)\n\n  USTAR_MAGIC.copy(buf, MAGIC_OFFSET)\n  USTAR_VER.copy(buf, VERSION_OFFSET)\n  if (opts.uname) buf.write(opts.uname, 265)\n  if (opts.gname) buf.write(opts.gname, 297)\n  buf.write(encodeOct(opts.devmajor || 0, 6), 329)\n  buf.write(encodeOct(opts.devminor || 0, 6), 337)\n\n  if (prefix) buf.write(prefix, 345)\n\n  buf.write(encodeOct(cksum(buf), 6), 148)\n\n  return buf\n}\n"]},"metadata":{},"sourceType":"script"}
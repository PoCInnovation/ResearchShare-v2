{"ast":null,"code":"import _regeneratorRuntime from\"/home/thalusa/Documents/ResearchShare-v2/reactrs/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/thalusa/Documents/ResearchShare-v2/reactrs/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/thalusa/Documents/ResearchShare-v2/reactrs/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import useIPFS from'../../utils/Ipfs';import'./ButtonUpload.css';import Button from'@material-ui/core/Button';import Input from'@material-ui/core/Input';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ButtonUpload(){var IPFS=useIPFS();var _React$useState=React.useState(\"\"),_React$useState2=_slicedToArray(_React$useState,2),filename=_React$useState2[0],setFileName=_React$useState2[1];var _React$useState3=React.useState(null),_React$useState4=_slicedToArray(_React$useState3,2),fileContent=_React$useState4[0],setFileContent=_React$useState4[1];var _React$useState5=React.useState(\"\"),_React$useState6=_slicedToArray(_React$useState5,2),fileHash=_React$useState6[0],setFileHash=_React$useState6[1];var _React$useState7=React.useState(\"\"),_React$useState8=_slicedToArray(_React$useState7,2),paperField=_React$useState8[0],setPaperField=_React$useState8[1];function changeField(event){setPaperField(event.target.value);}function changeFile(event){var _event$target$files$,_event$target$files,_event$target$files$2,_event$target$files2;setFileContent((_event$target$files$=(_event$target$files=event.target.files)===null||_event$target$files===void 0?void 0:_event$target$files[0])!==null&&_event$target$files$!==void 0?_event$target$files$:null);setFileName((_event$target$files$2=(_event$target$files2=event.target.files)===null||_event$target$files2===void 0?void 0:_event$target$files2[0].name)!==null&&_event$target$files$2!==void 0?_event$target$files$2:\"\");}function submitPaper(){return _submitPaper.apply(this,arguments);}function _submitPaper(){_submitPaper=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _filename$split$pop,ext,direntry;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(filename&&fileContent)){_context.next=10;break;}ext=(_filename$split$pop=filename.split('.').pop())!==null&&_filename$split$pop!==void 0?_filename$split$pop:\".txt\";_context.next=4;return IPFS.files.mkdir(\"/reactrs-paper\");case 4:_context.next=6;return IPFS.files.write(\"/reactrs-paper/\".concat(paperField).concat(ext),fileContent,{create:true});case 6:_context.next=8;return IPFS.files.stat(\"/reactrs-paper\");case 8:direntry=_context.sent;setFileHash(direntry.cid);case 10:case\"end\":return _context.stop();}}},_callee);}));return _submitPaper.apply(this,arguments);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{id:\"upload\",children:[/*#__PURE__*/_jsx(Input,{placeholder:\"Field\",onChange:changeField}),/*#__PURE__*/_jsx(\"input\",{id:\"upload-input\",onChange:changeFile,type:\"file\"}),/*#__PURE__*/_jsx(Button,{id:\"upload-button\",onClick:submitPaper,variant:\"contained\",color:\"primary\",children:\"Upload\"})]}),/*#__PURE__*/_jsx(\"br\",{}),fileHash?/*#__PURE__*/_jsx(\"div\",{id:\"upload-success\",children:\"Success: \".concat(fileHash)}):null]});}","map":{"version":3,"sources":["/home/thalusa/Documents/ResearchShare-v2/reactrs/src/components/ButtonUpload/ButtonUpload.tsx"],"names":["React","useIPFS","Button","Input","ButtonUpload","IPFS","useState","filename","setFileName","fileContent","setFileContent","fileHash","setFileHash","paperField","setPaperField","changeField","event","target","value","changeFile","files","name","submitPaper","ext","split","pop","mkdir","write","create","stat","direntry","cid"],"mappings":"kfAAA,MAAOA,CAAAA,KAAP,KAAmC,OAAnC,CACA,MAAOC,CAAAA,OAAP,KAAoB,kBAApB,CACA,MAAO,oBAAP,CAEA,MAAOC,CAAAA,MAAP,KAAmB,0BAAnB,CACA,MAAOC,CAAAA,KAAP,KAAkB,yBAAlB,C,wFAEA,cAAe,SAASC,CAAAA,YAAT,EAAwB,CACnC,GAAMC,CAAAA,IAAI,CAAGJ,OAAO,EAApB,CADmC,oBAEHD,KAAK,CAACM,QAAN,CAAe,EAAf,CAFG,oDAE5BC,QAF4B,qBAElBC,WAFkB,0CAGGR,KAAK,CAACM,QAAN,CAA4B,IAA5B,CAHH,qDAG5BG,WAH4B,qBAGfC,cAHe,0CAIHV,KAAK,CAACM,QAAN,CAAe,EAAf,CAJG,qDAI5BK,QAJ4B,qBAIlBC,WAJkB,0CAKCZ,KAAK,CAACM,QAAN,CAAe,EAAf,CALD,qDAK5BO,UAL4B,qBAKhBC,aALgB,qBAOnC,QAASC,CAAAA,WAAT,CAAqBC,KAArB,CAA2D,CACvDF,aAAa,CAACE,KAAK,CAACC,MAAN,CAAaC,KAAd,CAAb,CACH,CAED,QAASC,CAAAA,UAAT,CAAoBH,KAApB,CAA0D,yFACtDN,cAAc,4CAACM,KAAK,CAACC,MAAN,CAAaG,KAAd,8CAAC,oBAAqB,CAArB,CAAD,6DAA4B,IAA5B,CAAd,CACAZ,WAAW,8CAACQ,KAAK,CAACC,MAAN,CAAaG,KAAd,+CAAC,qBAAqB,CAArB,EAAwBC,IAAzB,+DAAiC,EAAjC,CAAX,CACH,CAdkC,QAgBpBC,CAAAA,WAhBoB,2IAgBnC,6KACQf,QAAQ,EAAIE,WADpB,2BAEcc,GAFd,sBAEoBhB,QAAQ,CAACiB,KAAT,CAAe,GAAf,EAAoBC,GAApB,EAFpB,2DAEiD,MAFjD,uBAGcpB,CAAAA,IAAI,CAACe,KAAL,CAAWM,KAAX,CAAiB,gBAAjB,CAHd,8BAIcrB,CAAAA,IAAI,CAACe,KAAL,CAAWO,KAAX,0BAAmCd,UAAnC,SAAgDU,GAAhD,EAAuDd,WAAvD,CAAoE,CAAEmB,MAAM,CAAE,IAAV,CAApE,CAJd,8BAK+BvB,CAAAA,IAAI,CAACe,KAAL,CAAWS,IAAX,CAAgB,gBAAhB,CAL/B,QAKcC,QALd,eAMQlB,WAAW,CAACkB,QAAQ,CAACC,GAAV,CAAX,CANR,uDAhBmC,8CAwBlC,CAED,mBACI,oCACI,aAAK,EAAE,CAAC,QAAR,wBACI,KAAC,KAAD,EAAO,WAAW,CAAC,OAAnB,CAA2B,QAAQ,CAAEhB,WAArC,EADJ,cAEI,cAAO,EAAE,CAAC,cAAV,CAAyB,QAAQ,CAAEI,UAAnC,CAA+C,IAAI,CAAC,MAApD,EAFJ,cAGI,KAAC,MAAD,EAAQ,EAAE,CAAC,eAAX,CAA2B,OAAO,CAAEG,WAApC,CAAiD,OAAO,CAAC,WAAzD,CAAqE,KAAK,CAAC,SAA3E,oBAHJ,GADJ,cAQI,aARJ,CASKX,QAAQ,cAAG,YAAK,EAAE,CAAC,gBAAR,6BAAsCA,QAAtC,GAAH,CAA6D,IAT1E,GADJ,CAaH","sourcesContent":["import React, { ChangeEvent } from 'react';\nimport useIPFS from '../../utils/Ipfs';\nimport './ButtonUpload.css';\n\nimport Button from '@material-ui/core/Button';\nimport Input from '@material-ui/core/Input';\n\nexport default function ButtonUpload() {\n    const IPFS = useIPFS();\n    const [filename, setFileName] = React.useState(\"\");\n    const [fileContent, setFileContent] = React.useState<File | null>(null);\n    const [fileHash, setFileHash] = React.useState(\"\");\n    const [paperField, setPaperField] = React.useState(\"\");\n\n    function changeField(event: ChangeEvent<HTMLInputElement>) {\n        setPaperField(event.target.value);\n    }\n\n    function changeFile(event: ChangeEvent<HTMLInputElement>) {\n        setFileContent(event.target.files?.[0] ?? null);\n        setFileName(event.target.files?.[0].name ?? \"\");\n    }\n\n    async function submitPaper() {\n        if (filename && fileContent) {\n            const ext = filename.split('.').pop() ?? \".txt\";\n            await IPFS.files.mkdir(\"/reactrs-paper\");\n            await IPFS.files.write(`/reactrs-paper/${paperField}${ext}`, fileContent, { create: true });\n            const direntry = await IPFS.files.stat(\"/reactrs-paper\");\n            setFileHash(direntry.cid);\n        }\n    };\n\n    return (\n        <div>\n            <div id=\"upload\">\n                <Input placeholder='Field' onChange={changeField} />\n                <input id=\"upload-input\" onChange={changeFile} type=\"file\"/>\n                <Button id=\"upload-button\" onClick={submitPaper} variant=\"contained\" color=\"primary\">\n                    Upload\n                </Button>\n            </div>\n            <br/>\n            {fileHash ? <div id=\"upload-success\">{`Success: ${fileHash}`}</div> : null}\n        </div>\n    );\n}"]},"metadata":{},"sourceType":"module"}